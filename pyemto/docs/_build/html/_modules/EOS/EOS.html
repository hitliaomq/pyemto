

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>EOS.EOS &mdash; pyEMTO 0.9.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.9.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/bizstyle.js"></script>
    <link rel="top" title="pyEMTO 0.9.0 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyEMTO 0.9.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for EOS.EOS</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Wed Dec  9 10:51:00 2014</span>

<span class="sd">@author: Matti Ropo</span>
<span class="sd">@author: Henrik Levämäki</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">leastsq</span>


<span class="k">def</span> <span class="nf">_general_function</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">function</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This part comes from:</span>

<span class="sd">    http://projects.scipy.org/scipy/browser/trunk/scipy/optimize/minpack.py</span>

<span class="sd">    :param params:</span>
<span class="sd">    :type params:</span>
<span class="sd">    :param xdata:</span>
<span class="sd">    :type xdata:</span>
<span class="sd">    :param ydata:</span>
<span class="sd">    :type ydata:</span>
<span class="sd">    :param function:</span>
<span class="sd">    :type function:</span>
<span class="sd">    :returns:</span>
<span class="sd">    :rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">function</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span> <span class="o">-</span> <span class="n">ydata</span>


<div class="viewcode-block" id="curve_fit"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.curve_fit">[docs]</a><span class="k">def</span> <span class="nf">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fits an arbitraty function to data (x,y).</span>

<span class="sd">    This part comes from:</span>
<span class="sd">    http://projects.scipy.org/scipy/browser/trunk/scipy/optimize/minpack.py</span>

<span class="sd">    :param f:</span>
<span class="sd">    :type f:</span>
<span class="sd">    :param x:</span>
<span class="sd">    :type x:</span>
<span class="sd">    :param y:</span>
<span class="sd">    :type y:</span>
<span class="sd">    :param p0:</span>
<span class="sd">    :type p0:</span>
<span class="sd">    :returns:</span>
<span class="sd">    :rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">func</span> <span class="o">=</span> <span class="n">_general_function</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">leastsq</span><span class="p">(</span>
        <span class="n">func</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">maxfev</span><span class="o">=</span><span class="mi">200000</span><span class="p">,</span> <span class="n">ftol</span><span class="o">=</span><span class="mf">1.0e-15</span><span class="p">,</span> <span class="n">xtol</span><span class="o">=</span><span class="mf">1.0e-15</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ier</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s">&quot;Optimal parameters not found: &quot;</span> <span class="o">+</span> <span class="n">mesg</span><span class="p">)</span>
    <span class="c"># end of this part</span>
    <span class="k">return</span> <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">ier</span>

</div>
<div class="viewcode-block" id="EOS"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS">[docs]</a><span class="k">class</span> <span class="nc">EOS</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Fit equation of state for bulk systems.</span>

<span class="sd">    The following equations are available:</span>

<span class="sd">    ================ ==============================================================</span>
<span class="sd">    morse            PRB 37, 790 (1988)</span>
<span class="sd">    sjeos            PRB 63, 224115 (2001)</span>
<span class="sd">    taylor           A third order Taylor series expansion about the minimum volume</span>
<span class="sd">    murnaghan        PRB 28, 5480 (1983)</span>
<span class="sd">    birch            Intermetallic compounds: Principles and Practice,</span>
<span class="sd">                     Vol I: Principles. pages 195-210</span>
<span class="sd">    birchmurnaghan   PRB 70, 224107</span>
<span class="sd">    pouriertarantola PRB 70, 224107</span>
<span class="sd">    vinet            PRB 70, 224107</span>
<span class="sd">    antonschmidt     Intermetallics 11, 23-32 (2003)</span>
<span class="sd">    oldpoly          A third order polynomial fit (alternative implementation)</span>
<span class="sd">    ================ ==============================================================</span>

<span class="sd">    Use::</span>

<span class="sd">       eos = EquationOfState(volumes, energies, eos=&#39;murnaghan&#39;)</span>
<span class="sd">       v0, e0, B = eos.fit()</span>
<span class="sd">       eos.plot()</span>

<span class="sd">    :param name:</span>
<span class="sd">    :type name:</span>
<span class="sd">    :param xc:  (Default value = &#39;PBE&#39;)</span>
<span class="sd">    :type xc:</span>
<span class="sd">    :param method:  (Default value = &#39;morse&#39;)</span>
<span class="sd">    :type method:</span>
<span class="sd">    :param units:  (Default value = &#39;bohr&#39;)</span>
<span class="sd">    :type units:</span>
<span class="sd">    :returns:</span>
<span class="sd">    :rtype:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">xc</span><span class="o">=</span><span class="s">&#39;PBE&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s">&#39;morse&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&#39;bohr&#39;</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">=</span> <span class="n">xc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relerror</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nq</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bohr2a</span> <span class="o">=</span> <span class="mf">0.52917721092</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">=</span> <span class="mf">13.605692533</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span> <span class="o">=</span> <span class="mf">160.21773</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span> <span class="o">=</span> <span class="bp">None</span>

<div class="viewcode-block" id="EOS.vol2wsrad"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.vol2wsrad">[docs]</a>    <span class="k">def</span> <span class="nf">vol2wsrad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">V</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="EOS.wsrad2vol"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.wsrad2vol">[docs]</a>    <span class="k">def</span> <span class="nf">wsrad2vol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">WSrad</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param WSrad:</span>
<span class="sd">        :type WSrad:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#print(&#39;debug:&#39;, WSrad)</span>
        <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">WSrad</span><span class="o">**</span><span class="mi">3</span>
</div>
<div class="viewcode-block" id="EOS.angstrom2bohr"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.angstrom2bohr">[docs]</a>    <span class="k">def</span> <span class="nf">angstrom2bohr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">V</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.52917721092</span>
</div>
<div class="viewcode-block" id="EOS.bohr2angstrom"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.bohr2angstrom">[docs]</a>    <span class="k">def</span> <span class="nf">bohr2angstrom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">WSrad</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param WSrad:</span>
<span class="sd">        :type WSrad:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">WSrad</span> <span class="o">*</span> <span class="mf">0.52917721092</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
</div>
<div class="viewcode-block" id="EOS.morse"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.morse">[docs]</a>    <span class="k">def</span> <span class="nf">morse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param w:</span>
<span class="sd">        :type w:</span>
<span class="sd">        :param a0:</span>
<span class="sd">        :type a0:</span>
<span class="sd">        :param b0:</span>
<span class="sd">        :type b0:</span>
<span class="sd">        :param c0:</span>
<span class="sd">        :type c0:</span>
<span class="sd">        :param l0:</span>
<span class="sd">        :type l0:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">l0</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span> <span class="o">+</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">l0</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.taylor"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.taylor">[docs]</a>    <span class="k">def</span> <span class="nf">taylor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Taylor Expansion up to 3rd order about V0</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param beta:</span>
<span class="sd">        :type beta:</span>
<span class="sd">        :param alpha:</span>
<span class="sd">        :type alpha:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">V0</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">6.</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">/</span> <span class="n">V0</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.murnaghan"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.murnaghan">[docs]</a>    <span class="k">def</span> <span class="nf">murnaghan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From PRB 28,5480 (1983)</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param B0:</span>
<span class="sd">        :type B0:</span>
<span class="sd">        :param BP:</span>
<span class="sd">        :type BP:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">+</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V</span> <span class="o">/</span> <span class="n">BP</span> <span class="o">*</span> \
            <span class="p">(((</span><span class="n">V0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="n">BP</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">V0</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">/</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.birch"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.birch">[docs]</a>    <span class="k">def</span> <span class="nf">birch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From Intermetallic compounds: Principles and Practice, Vol. I: Principles</span>
<span class="sd">        Chapter 9 pages 195-210 by M. Mehl. B. Klein, D. Papaconstantopoulos</span>
<span class="sd">        paper downloaded from Web</span>

<span class="sd">        case where n=0</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param B0:</span>
<span class="sd">        :type B0:</span>
<span class="sd">        :param BP:</span>
<span class="sd">        :type BP:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">E0</span> <span class="o">+</span> <span class="mf">9.0</span> <span class="o">/</span> <span class="mf">8.0</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">*</span> <span class="p">((</span><span class="n">V0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
             <span class="mf">9.0</span> <span class="o">/</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">*</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mf">4.</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">V0</span> <span class="o">/</span> <span class="n">V</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.birchmurnaghan"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.birchmurnaghan">[docs]</a>    <span class="k">def</span> <span class="nf">birchmurnaghan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        BirchMurnaghan equation from PRB 70, 224107</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param B0:</span>
<span class="sd">        :type B0:</span>
<span class="sd">        :param BP:</span>
<span class="sd">        :type BP:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">+</span> <span class="mf">9.</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">/</span> <span class="mf">16.</span> <span class="o">*</span> \
            <span class="p">(</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">6</span> <span class="o">+</span> <span class="n">BP</span> <span class="o">*</span> <span class="p">(</span><span class="n">eta</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">4.</span> <span class="o">*</span> <span class="n">eta</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.pouriertarantola"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.pouriertarantola">[docs]</a>    <span class="k">def</span> <span class="nf">pouriertarantola</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pourier-Tarantola equation from PRB 70, 224107</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param B0:</span>
<span class="sd">        :type B0:</span>
<span class="sd">        :param BP:</span>
<span class="sd">        :type BP:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>
        <span class="n">squiggle</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">+</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">*</span> <span class="n">squiggle</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">6.</span> <span class="o">*</span> <span class="p">(</span><span class="mf">3.</span> <span class="o">+</span> <span class="n">squiggle</span> <span class="o">*</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.vinet"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.vinet">[docs]</a>    <span class="k">def</span> <span class="nf">vinet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vinet equation from PRB 70, 224107</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param E0:</span>
<span class="sd">        :type E0:</span>
<span class="sd">        :param B0:</span>
<span class="sd">        :type B0:</span>
<span class="sd">        :param BP:</span>
<span class="sd">        :type BP:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">eta</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>

        <span class="n">E</span> <span class="o">=</span> <span class="p">(</span><span class="n">E0</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">/</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mf">2.</span> <span class="o">-</span> <span class="p">(</span><span class="mf">5.</span> <span class="o">+</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">BP</span> <span class="o">*</span> <span class="p">(</span><span class="n">eta</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">-</span> <span class="mf">3.</span> <span class="o">*</span> <span class="n">eta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">3.</span> <span class="o">*</span> <span class="p">(</span><span class="n">BP</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">eta</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">))</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.antonschmidt"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.antonschmidt">[docs]</a>    <span class="k">def</span> <span class="nf">antonschmidt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">Einf</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">V0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;From Intermetallics 11, 23-32 (2003)</span>

<span class="sd">        Einf should be E_infinity, i.e. infinite separation, but</span>
<span class="sd">        according to the paper it does not provide a good estimate</span>
<span class="sd">        of the cohesive energy. They derive this equation from an</span>
<span class="sd">        empirical formula for the volume dependence of pressure,</span>

<span class="sd">        E(vol) = E_inf + int(P dV) from V=vol to V=infinity</span>

<span class="sd">        but the equation breaks down at large volumes, so E_inf</span>
<span class="sd">        is not that meaningful</span>

<span class="sd">        n should be about -2 according to the paper.</span>

<span class="sd">        I find this equation does not fit volumetric data as well</span>
<span class="sd">        as the other equtions do.</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param Einf:</span>
<span class="sd">        :type Einf:</span>
<span class="sd">        :param B:</span>
<span class="sd">        :type B:</span>
<span class="sd">        :param n:</span>
<span class="sd">        :type n:</span>
<span class="sd">        :param V0:</span>
<span class="sd">        :type V0:</span>
<span class="sd">        :returns: Energy</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">B</span> <span class="o">*</span> <span class="n">V0</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">V0</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)</span> <span class="o">*</span> \
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">V</span> <span class="o">/</span> <span class="n">V0</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mf">1.</span><span class="p">)))</span> <span class="o">+</span> <span class="n">Einf</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.oldpoly"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.oldpoly">[docs]</a>    <span class="k">def</span> <span class="nf">oldpoly</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;polynomial fit, 3rd order</span>

<span class="sd">        :param V:</span>
<span class="sd">        :type V:</span>
<span class="sd">        :param c0:</span>
<span class="sd">        :type c0:</span>
<span class="sd">        :param c1:</span>
<span class="sd">        :type c1:</span>
<span class="sd">        :param c2:</span>
<span class="sd">        :type c2:</span>
<span class="sd">        :param c3:</span>
<span class="sd">        :type c3:</span>
<span class="sd">        :returns: Energy</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">V</span> <span class="o">+</span> <span class="n">c2</span> <span class="o">*</span> <span class="n">V</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c3</span> <span class="o">*</span> <span class="n">V</span><span class="o">**</span><span class="mi">3</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.parabola"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.parabola">[docs]</a>    <span class="k">def</span> <span class="nf">parabola</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parabola polynomial function</span>

<span class="sd">        This function is used to fit the data to get good guesses for</span>
<span class="sd">        the equation of state fits.</span>

<span class="sd">        A 4th order polynomial fit to get good guesses for</span>
<span class="sd">        was not a good idea because for noisy data the fit is too wiggly</span>
<span class="sd">        2nd order seems to be sufficient, and guarentees a single minimum.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param a:</span>
<span class="sd">        :type a:</span>
<span class="sd">        :param b:</span>
<span class="sd">        :type b:</span>
<span class="sd">        :param c:</span>
<span class="sd">        :type c:</span>
<span class="sd">        :returns: Energy</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</div>
<div class="viewcode-block" id="EOS.predicted"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.predicted">[docs]</a>    <span class="k">def</span> <span class="nf">predicted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluates the EOS function using the calc. EOS params.</span>

<span class="sd">        :returns: EOS function</span>
<span class="sd">        :rtype: func</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fity</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
        <span class="k">return</span> <span class="n">fity</span>
</div>
<div class="viewcode-block" id="EOS.prepareData"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.prepareData">[docs]</a>    <span class="k">def</span> <span class="nf">prepareData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fitpts</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;fit/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;.fit&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">timeline</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span>\
            <span class="s">&quot; -- &quot;</span> <span class="o">+</span> <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span>\
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> \
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">second</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">fitpts</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="n">timeline</span> <span class="o">+</span>
            <span class="s">&quot;JOBNAM = &quot;</span> <span class="o">+</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>
            <span class="s">&#39; -- &#39;</span> <span class="o">+</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

        <span class="n">namelist</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">&quot;kfcd/&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">:</span>
                <span class="n">namelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="n">enTag</span> <span class="o">=</span> <span class="s">&#39;TOT-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span>
        <span class="n">volTag</span> <span class="o">=</span> <span class="s">&#39;VOL&#39;</span>
        <span class="n">nqTag</span> <span class="o">=</span> <span class="s">&#39;NQ&#39;</span>
        <span class="n">nq</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">namelist</span><span class="p">:</span>
            <span class="n">nqRead</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">lineIndex</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;kfcd/&quot;</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">fl</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">nqRead</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nqTag</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                        <span class="n">nq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">nqRead</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                if volTag in line:</span>
<span class="sd">                    # cellVol = volume of the cell in unit</span>
<span class="sd">                    # of cellA**3</span>
<span class="sd">                    cellVol = float(line.split()[5])</span>
<span class="sd">                    #cellA = length of the lattice parameter A</span>
<span class="sd">                    # in unit of Bohr</span>
<span class="sd">                    cellA = float(lines[lineIndex+2].split()[2])</span>
<span class="sd">                    #</span>
<span class="sd">                    cellVol = cellVol*cellA**3</span>
<span class="sd">                    cellWSRad = (3.0*cellVol/(4*np.pi))**(1.0/3.0)</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="k">if</span> <span class="n">enTag</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">linesplit</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[[</span><span class="nb">float</span><span class="p">(</span><span class="n">linesplit</span><span class="p">[</span><span class="mi">6</span><span class="p">]),</span>
                                             <span class="nb">float</span><span class="p">(</span><span class="n">linesplit</span><span class="p">[</span><span class="mi">3</span><span class="p">])]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">lineIndex</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">fl</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c"># Make sure datapoints are in ascending order</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>

        <span class="n">fitpts</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;NQ = {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitpts</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;Sws.......Etot...........&quot;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])):</span>
            <span class="n">fitpts</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;{0:.6f} {1:.6f}</span><span class="se">\n</span><span class="s">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="n">fitpts</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="EOS.fit"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.fit">[docs]</a>    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">swses</span><span class="p">,</span> <span class="n">energies</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate volume, energy, and bulk modulus.</span>

<span class="sd">        A fitting input file is created in the &#39;/fit&#39; folder.</span>
<span class="sd">        Returns the optimal volume, the minumum energy, and the bulk</span>
<span class="sd">        modulus.  Notice that the units for the bulk modulus is</span>
<span class="sd">        eV/Angstrom^3 - to get the value in GPa, do this::</span>

<span class="sd">        v0, e0, B = eos.fit()</span>
<span class="sd">        print B*160.21773, &#39;GPa&#39;</span>

<span class="sd">        :param swses: List of WS-radii</span>
<span class="sd">        :type swses: list(float)</span>
<span class="sd">        :param energies: List of energies</span>
<span class="sd">        :type energies: list(float)</span>
<span class="sd">        :returns: Eq. WS-rad, energy, bulk modulus, Gruneisen parameter</span>
<span class="sd">        :rtype: float, float, float, float</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">swses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">energies</span><span class="p">)</span>
        <span class="c"># Remove duplicates and make sure the arrays are sorted</span>
        <span class="n">vLen0</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">uniqueInd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">return_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)[</span><span class="n">uniqueInd</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">vLen0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;EOS.fit(): WARNING! Duplicate volumes have been detected.&#39;</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span>\
                  <span class="s">&#39;Duplicates have been removed in no particular fashion.&#39;</span> <span class="o">+</span>
                  <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span>\
                  <span class="s">&#39;Check the integrity of the data!&#39;</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">!=</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
            <span class="c"># Convert WS-radius to Angstrom^3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bohr2a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:])</span><span class="o">**</span><span class="mi">3</span>
            <span class="c"># Convert Rydberg to eV (No need to do this unless one wants to</span>
            <span class="c"># print out in eVs)</span>
            <span class="c"># self.e[:] *= self.ry2ev</span>
        <span class="c"># Translate energies so that smallest value becomes zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="n">fit0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">**-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="n">fit1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyder</span><span class="p">(</span><span class="n">fit0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">fit2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyder</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">fit1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fit2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="n">t</span><span class="o">**-</span><span class="mi">3</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;sjeos: No minimum!&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">fit0</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">t</span><span class="o">**</span><span class="mi">5</span> <span class="o">*</span> <span class="n">fit2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span> <span class="o">=</span> <span class="n">fit0</span>
            <span class="c"># Convert B to GPa</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict0</span><span class="p">,</span> <span class="n">mesg0</span><span class="p">,</span> <span class="n">ier0</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad2vol</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict0</span><span class="p">,</span> <span class="n">mesg0</span><span class="p">,</span> <span class="n">ier0</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

            <span class="n">parabola_parameters</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="c"># Here I just make sure the minimum is bracketed by the volumes</span>
            <span class="c"># this if for the solver</span>
            <span class="n">minvol</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
            <span class="n">maxvol</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>

            <span class="c"># the minimum of the parabola is at dE/dV = 0, or 2*c V +b =0</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">parabola_vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">c</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">parabola_vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol2wsrad</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">)</span>
            <span class="c"># print(&#39;parabola_vmin=&#39;,parabola_vmin)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">minvol</span> <span class="o">&lt;</span> <span class="n">parabola_vmin</span> <span class="ow">and</span> <span class="n">parabola_vmin</span> <span class="o">&lt;</span> <span class="n">maxvol</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;EOS.fit(): Warning the minimum volume of a fitted&#39;</span> <span class="o">+</span>\
                      <span class="s">&#39; parabola is not in your volumes.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span>\
                      <span class="s">&#39;           You may not have a minimum in your dataset.&#39;</span><span class="p">)</span>

            <span class="c"># evaluate the parabola at the minimum to estimate the groundstate</span>
            <span class="c"># energy</span>
            <span class="n">E0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="c"># print(&#39;parabola_E0=&#39;,E0)</span>
            <span class="c"># estimate the bulk modulus from Vo*E&#39;&#39;.  E&#39;&#39; = 2*c</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">B0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad2vol</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">B0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">parabola_vmin</span>
            <span class="c"># print(&#39;parabola_B0=&#39;,B0)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;antonschmidt&#39;</span><span class="p">:</span>
                <span class="n">BP</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BP</span> <span class="o">=</span> <span class="mi">4</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">w0</span> <span class="o">=</span> <span class="n">parabola_vmin</span>
                <span class="n">l0</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">w0</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">l0</span> <span class="o">*</span> <span class="n">w0</span><span class="p">)</span>
                <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">/</span> <span class="p">(</span><span class="n">x0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l0</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">b0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x0</span>
                <span class="n">a0</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">-</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">]</span>
                <span class="c"># print(&#39;a0=&#39;,a0,&#39;b0=&#39;,b0,&#39;c0=&#39;,c0,&#39;lambda0=&#39;,l0)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">parabola_vmin</span><span class="p">]</span>

            <span class="c"># now fit the equation of state</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="n">initial_guess</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span> <span class="o">=</span> <span class="n">popt</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">ma</span><span class="p">,</span> <span class="n">mb</span><span class="p">,</span> <span class="n">mc</span><span class="p">,</span> <span class="n">ml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span>
                <span class="c"># print(&#39;morse_a=&#39;,ma,&#39;morse_b=&#39;,mb,&#39;morse_c=&#39;,mc,&#39;morse_lambda=&#39;,ml)</span>
                <span class="n">mx0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">mb</span> <span class="o">/</span> <span class="n">mc</span>
                <span class="c"># print(&#39;morse_x0=&#39;,mx0)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mx0</span><span class="p">)</span> <span class="o">/</span> <span class="n">ml</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">ma</span> <span class="o">+</span> <span class="n">mb</span> <span class="o">*</span> <span class="n">mx0</span> <span class="o">+</span> <span class="n">mc</span> <span class="o">*</span> <span class="n">mx0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">mc</span> <span class="o">*</span> <span class="n">mx0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ml</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mx0</span><span class="p">))</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bohr2a</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ml</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;oldpoly&#39;</span><span class="p">:</span>
                <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span>
                <span class="c"># find minimum E in E = c0 + c1*V + c2*V**2 + c3*V**3</span>
                <span class="c"># dE/dV = c1+ 2*c2*V + 3*c3*V**2 = 0</span>
                <span class="c"># solve by quadratic formula with the positive root</span>

                <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c3</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c2</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">c1</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oldpoly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="c"># Convert e0 to Rydbergs</span>
                <span class="c">#self.e0 /= self.ry2ev</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">c3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>
                <span class="c"># Gruneisen parameter for oldpoly not implemented</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="c"># Convert e0 to Rydbergs</span>
                <span class="c">#self.e0 /= self.ry2ev</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bohr2angstrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="n">sjeospredicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">**-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">sjeospredicted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="n">ss_tot</span>
            <span class="n">fitE</span> <span class="o">=</span> <span class="n">sjeospredicted</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span> <span class="o">=</span> <span class="n">infodict</span><span class="p">[</span><span class="s">&#39;fvec&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="n">ss_tot</span>
            <span class="n">fitE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicted</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

        <span class="c"># Calculate WS-radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>

        <span class="c"># Printouts</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">timeline</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span>\
            <span class="s">&quot; -- &quot;</span> <span class="o">+</span> <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span>\
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> \
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">second</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="n">timeline</span> <span class="o">+</span> <span class="s">&quot;JOBNAM = &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39; -- &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Using &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">+</span> <span class="s">&#39; function&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Chi squared         = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Reduced Chi squared = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redchi</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;R squared           = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">+</span> <span class="s">&#39; parameters:&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;a      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;b      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;lambda = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;a = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;b = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;d = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;oldpoly&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c0 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c1 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c2 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;c3 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;E0    = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Bmod  = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Bmod</span><span class="se">\&#39;</span><span class="s"> = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;V0    = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Ground state parameters:&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;V0           = {0:12.6f} Bohr^3 (unit cell volume)&#39;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">))</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;             = {0:12.6f} Bohr   (WS-radius)&#39;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;V0           = {0:12.6f} Angstrom^3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;E0           = {0:12.6f} Ry&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nq</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Bmod         = {0:12.6f} GPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;Grun. param. = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grun</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;sws            Einp           Eout          Residual       &#39;</span> <span class="o">+</span>
              <span class="s">&#39;err (% * 10**6)&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)):</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;{0:.6f} {1:13.6f} {2:13.6f} {3:13.6f} {4:15.6f}&#39;</span>
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fitE</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1.0E6</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>

        <span class="c"># Save an image for quality checking</span>
        <span class="c">#self.plot(filename=self.name, show=None)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grun</span>  <span class="c"># , self.error</span>
</div>
<div class="viewcode-block" id="EOS.fit2file"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.fit2file">[docs]</a>    <span class="k">def</span> <span class="nf">fit2file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate volume, energy, and bulk modulus.</span>

<span class="sd">        Returns the optimal volume, the minumum energy, and the bulk</span>
<span class="sd">        modulus.  Notice that the units for the bulk modulus is</span>
<span class="sd">        eV/Angstrom^3 - to get the value in GPa, do this::</span>

<span class="sd">          v0, e0, B = eos.fit()</span>
<span class="sd">          print B*160.21773, &#39;GPa&#39;</span>

<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Read data from the fit folder</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;fit/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;.fit&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="nb">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nq</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>
        <span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;fit/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;.fit&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">!=</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
            <span class="c"># Convert WS-radius to Angstrom^3</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:]</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bohr2a</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[:])</span><span class="o">**</span><span class="mi">3</span>
            <span class="c"># Convert Rydberg to eV (No need to do this unless one wants to</span>
            <span class="c"># print out in eVs)</span>
            <span class="c"># self.e[:] *= self.ry2ev</span>
        <span class="c"># Translate energies so that smallest value becomes zero</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="n">fit0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">**-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="n">fit1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyder</span><span class="p">(</span><span class="n">fit0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">fit2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyder</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">fit1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">fit2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="n">t</span><span class="o">**-</span><span class="mi">3</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;sjeos: No minimum!&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">fit0</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">t</span><span class="o">**</span><span class="mi">5</span> <span class="o">*</span> <span class="n">fit2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">9</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span> <span class="o">=</span> <span class="n">fit0</span>
            <span class="c"># Convert B to GPa</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict0</span><span class="p">,</span> <span class="n">mesg0</span><span class="p">,</span> <span class="n">ier0</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad2vol</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict0</span><span class="p">,</span> <span class="n">mesg0</span><span class="p">,</span> <span class="n">ier0</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

            <span class="n">parabola_parameters</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="c"># Here I just make sure the minimum is bracketed by the volumes</span>
            <span class="c"># this if for the solver</span>
            <span class="n">minvol</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
            <span class="n">maxvol</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>

            <span class="c"># the minimum of the parabola is at dE/dV = 0, or 2*c V +b =0</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">parabola_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">parabola_vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">b</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">c</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">parabola_vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol2wsrad</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">)</span>
            <span class="c"># print(&#39;parabola_vmin=&#39;,parabola_vmin)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">minvol</span> <span class="o">&lt;</span> <span class="n">parabola_vmin</span> <span class="ow">and</span> <span class="n">parabola_vmin</span> <span class="o">&lt;</span> <span class="n">maxvol</span><span class="p">):</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;EOS.fit2file(): Warning the minimum volume of a fitted&#39;</span> <span class="o">+</span>\
                      <span class="s">&#39; parabola is not in your volumes.</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span>\
                      <span class="s">&#39;                You may not have a minimum in your dataset.&#39;</span><span class="p">)</span>

            <span class="c"># evaluate the parabola at the minimum to estimate the groundstate</span>
            <span class="c"># energy</span>
            <span class="n">E0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parabola</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
            <span class="c"># print(&#39;parabola_E0=&#39;,E0)</span>
            <span class="c"># estimate the bulk modulus from Vo*E&#39;&#39;.  E&#39;&#39; = 2*c</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">B0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad2vol</span><span class="p">(</span><span class="n">parabola_vmin</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">B0</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c</span> <span class="o">*</span> <span class="n">parabola_vmin</span>
            <span class="c"># print(&#39;parabola_B0=&#39;,B0)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;antonschmidt&#39;</span><span class="p">:</span>
                <span class="n">BP</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BP</span> <span class="o">=</span> <span class="mi">4</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">w0</span> <span class="o">=</span> <span class="n">parabola_vmin</span>
                <span class="n">l0</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">/</span> <span class="n">w0</span>
                <span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">l0</span> <span class="o">*</span> <span class="n">w0</span><span class="p">)</span>
                <span class="n">c0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="n">B0</span> <span class="o">/</span> <span class="p">(</span><span class="n">x0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l0</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">b0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x0</span>
                <span class="n">a0</span> <span class="o">=</span> <span class="n">E0</span> <span class="o">-</span> <span class="n">b0</span> <span class="o">*</span> <span class="n">x0</span> <span class="o">-</span> <span class="n">c0</span> <span class="o">*</span> <span class="n">x0</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="n">a0</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">l0</span><span class="p">]</span>
                <span class="c"># print(&#39;a0=&#39;,a0,&#39;b0=&#39;,b0,&#39;c0=&#39;,c0,&#39;lambda0=&#39;,l0)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="n">E0</span><span class="p">,</span> <span class="n">B0</span><span class="p">,</span> <span class="n">BP</span><span class="p">,</span> <span class="n">parabola_vmin</span><span class="p">]</span>

            <span class="c"># now fit the equation of state</span>
            <span class="n">p0</span> <span class="o">=</span> <span class="n">initial_guess</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
                <span class="nb">eval</span><span class="p">(</span>
                    <span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span> <span class="o">=</span> <span class="n">popt</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">ma</span><span class="p">,</span> <span class="n">mb</span><span class="p">,</span> <span class="n">mc</span><span class="p">,</span> <span class="n">ml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span>
                <span class="c"># print(&#39;morse_a=&#39;,ma,&#39;morse_b=&#39;,mb,&#39;morse_c=&#39;,mc,&#39;morse_lambda=&#39;,ml)</span>
                <span class="n">mx0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">mb</span> <span class="o">/</span> <span class="n">mc</span>
                <span class="c"># print(&#39;morse_x0=&#39;,mx0)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mx0</span><span class="p">)</span> <span class="o">/</span> <span class="n">ml</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">ma</span> <span class="o">+</span> <span class="n">mb</span> <span class="o">*</span> <span class="n">mx0</span> <span class="o">+</span> <span class="n">mc</span> <span class="o">*</span> <span class="n">mx0</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">mc</span> <span class="o">*</span> <span class="n">mx0</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">ml</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">mx0</span><span class="p">))</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bohr2a</span><span class="o">**</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">ml</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;oldpoly&#39;</span><span class="p">:</span>
                <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span>
                <span class="c"># find minimum E in E = c0 + c1*V + c2*V**2 + c3*V**3</span>
                <span class="c"># dE/dV = c1+ 2*c2*V + 3*c3*V**2 = 0</span>
                <span class="c"># solve by quadratic formula with the positive root</span>

                <span class="n">a</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">c3</span>
                <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">c2</span>
                <span class="n">c</span> <span class="o">=</span> <span class="n">c1</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oldpoly</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="c"># Convert e0 to Rydbergs</span>
                <span class="c">#self.e0 /= self.ry2ev</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">c2</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">c3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>
                <span class="c"># Gruneisen parameter for oldpoly not implemented</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>
                <span class="c"># Convert e0 to Rydbergs</span>
                <span class="c">#self.e0 /= self.ry2ev</span>
                <span class="c"># Convert B to GPa</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ev2gpa</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bohr2angstrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="n">sjeospredicted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">**-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">sjeospredicted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="n">ss_tot</span>
            <span class="n">fitE</span> <span class="o">=</span> <span class="n">sjeospredicted</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span> <span class="o">=</span> <span class="n">infodict</span><span class="p">[</span><span class="s">&#39;fvec&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span> <span class="o">/</span> <span class="n">ss_tot</span>
            <span class="n">fitE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predicted</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span>

        <span class="c"># Calculate WS-radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span>
        <span class="c"># Calculate unit cell volume</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="o">**</span><span class="mf">3.0</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nq</span>

        <span class="c"># Write results to a text file</span>
        <span class="n">fitresult</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;fit/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">&#39;.prn&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">timeline</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">month</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">+</span>\
            <span class="s">&quot; -- &quot;</span> <span class="o">+</span> <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span>\
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;:&quot;</span> <span class="o">+</span> \
            <span class="s">&quot;{0:02}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="o">.</span><span class="n">second</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="n">timeline</span> <span class="o">+</span>
            <span class="s">&quot;JOBNAM = &quot;</span> <span class="o">+</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>
            <span class="s">&#39; -- &#39;</span> <span class="o">+</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xc</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Using &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">+</span> <span class="s">&#39; function&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Chi squared         = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Reduced Chi squared = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redchi</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;R squared           = &#39;</span> <span class="o">+</span>
                        <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span><span class="p">)</span> <span class="o">+</span>
                        <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                        <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">+</span> <span class="s">&#39; parameters:&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;a      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;b      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;c      = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;lambda = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;a = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;b = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;c = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;d = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;oldpoly&#39;</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;c0 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;c1 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;c2 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;c3 = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;E0    = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;Bmod  = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;Bmod</span><span class="se">\&#39;</span><span class="s"> = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;V0    = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Ground state parameters:&#39;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;V0           = {0:12.6f} Bohr^3 (unit cell volume)&#39;</span> <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;             = {0:12.6f} Bohr   (WS-radius)&#39;</span>
                            <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;V0           = {0:12.6f} Angstrom^3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">)</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s">&#39;E0           = {0:12.6f} Ry&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">*</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&#39;Bmod         = {0:12.6f} GPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s">&#39;Grun. param. = {0:12.6f}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grun</span><span class="p">)</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
            <span class="s">&#39;sws            Einp           Eout          Residual       &#39;</span> <span class="o">+</span>
            <span class="s">&#39;err (% * 10**6)&#39;</span> <span class="o">+</span>
            <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">)):</span>
            <span class="n">fitresult</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                <span class="s">&#39;{0:.6f} {1:13.6f} {2:13.6f} {3:13.6f} {4:15.6f}&#39;</span> <span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">fitE</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">residuals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span>
                    <span class="mf">1.0E6</span><span class="p">)</span> <span class="o">+</span>
                <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="n">fitresult</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c"># Save an image for quality checking</span>
        <span class="c">#self.plot(filename=self.name, show=None)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsrad</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grun</span>  <span class="c"># , self.error</span>
</div>
<div class="viewcode-block" id="EOS.plot"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot fitted energy curve.</span>

<span class="sd">        Uses Matplotlib to plot the energy curve.  Use *show=True* to</span>
<span class="sd">        show the figure and *filename=&#39;abc.png&#39;* or</span>
<span class="sd">        *filename=&#39;abc.eps&#39;* to save the figure to a file.</span>

<span class="sd">        :param filename:  (Default value = None)</span>
<span class="sd">        :type filename:</span>
<span class="sd">        :param show:  (Default value = None)</span>
<span class="sd">        :type show:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="kn">as</span> <span class="nn">mpl</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s">&#39;Agg&#39;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
        <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">ScalarFormatter</span><span class="p">,</span> <span class="n">FormatStrFormatter</span>
        <span class="c">#import pylab as plt</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v0</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;plot(): self.v0 is None!&#39;</span><span class="p">)</span>
            <span class="c"># self.fit()</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">show</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">show</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
                    <span class="n">x</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;sjeos&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sjeosfit0</span><span class="p">(</span><span class="n">x</span><span class="o">**-</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">))</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
                    <span class="n">x</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angstrom2bohr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span> <span class="o">==</span> <span class="s">&#39;morse&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bohr2angstrom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
                    <span class="n">x</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bohr2angstrom</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span><span class="p">,</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
                    <span class="n">x</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
                <span class="n">y</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ry2ev</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;-r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;energy [Ry]&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.6f</span><span class="s">&#39;</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.2</span><span class="p">,</span>
            <span class="mf">0.75</span><span class="p">,</span>
            <span class="s">&#39;Chi^2 = {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chisqr</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.2</span><span class="p">,</span>
            <span class="mf">0.7</span><span class="p">,</span>
            <span class="s">&#39;Red. Chi^2 = {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redchi</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
            <span class="mf">0.2</span><span class="p">,</span>
            <span class="mf">0.65</span><span class="p">,</span>
            <span class="s">&#39;R^2 = {0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rsquared</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;bohr&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;volume [sws (in Bohr)]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                <span class="s">&#39;{0}: E0: {1:.3f} Ry, w0: {2:.3f} Bohr, B0: {3:3.1f} GPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s">&#39;angstrom&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;volume [Angstrom^3]&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
                <span class="s">&#39;{0}: E0: {1:.3f} Ry, V0: {2:.3f} Angstrom^3, B0: {3:3.1f} GPa&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">v0</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="c"># plt.tight_layout()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&quot;fit/{0}.png&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>

        <span class="c"># return f</span>
</div>
<div class="viewcode-block" id="EOS.fit_eval"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.fit_eval">[docs]</a>    <span class="k">def</span> <span class="nf">fit_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sws</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Evaluate the fitting function at given points</span>

<span class="sd">        :param sws:</span>
<span class="sd">        :type sws:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">y</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eos_string</span><span class="p">))(</span>
            <span class="n">sws</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eMin</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eos_parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">],)</span>
        <span class="k">return</span> <span class="n">y</span>
</div>
<div class="viewcode-block" id="EOS.ca_fit"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.ca_fit">[docs]</a>    <span class="k">def</span> <span class="nf">ca_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fits a polynomial to x vs. y data and calculates</span>
<span class="sd">        xmin and ymin from the curve.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param y:</span>
<span class="sd">        :type y:</span>
<span class="sd">        :param n:</span>
<span class="sd">        :type n:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">xmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xmin</span><span class="p">,</span> <span class="n">ymin</span>
</div>
<div class="viewcode-block" id="EOS.distortion_poly1"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.distortion_poly1">[docs]</a>    <span class="k">def</span> <span class="nf">distortion_poly1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;One variable form of the 2nd order polynomial</span>
<span class="sd">           which is used to fitting distortion vs. energy</span>
<span class="sd">           data in order to find elastic constants.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param a2:</span>
<span class="sd">        :type a2:</span>
<span class="sd">        :param a1:</span>
<span class="sd">        :type a1:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.distortion_poly2"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.distortion_poly2">[docs]</a>    <span class="k">def</span> <span class="nf">distortion_poly2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Two variable form of the 2nd order polynomial</span>
<span class="sd">           which is used to fitting distortion vs. energy</span>
<span class="sd">           data in order to find elastic constants.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param a2:</span>
<span class="sd">        :type a2:</span>
<span class="sd">        :param a0:</span>
<span class="sd">        :type a0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a0</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.distortion_poly3"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.distortion_poly3">[docs]</a>    <span class="k">def</span> <span class="nf">distortion_poly3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Three variable form of the 2nd order polynomial</span>
<span class="sd">           which is used to fitting distortion vs. energy</span>
<span class="sd">           data in order to find elastic constants.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param a2:</span>
<span class="sd">        :type a2:</span>
<span class="sd">        :param a1:</span>
<span class="sd">        :type a1:</span>
<span class="sd">        :param a0:</span>
<span class="sd">        :type a0:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a1</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a0</span>
        <span class="k">return</span> <span class="n">E</span>
</div>
<div class="viewcode-block" id="EOS.distortion_fit"><a class="viewcode-back" href="../../apidoc_EOS/EOS.html#EOS.EOS.EOS.distortion_fit">[docs]</a>    <span class="k">def</span> <span class="nf">distortion_fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fits the distortion_poly function to</span>
<span class="sd">        the distortion data.</span>

<span class="sd">        num : number of variables in the fitting function</span>
<span class="sd">          1 : E=a2*x**2</span>
<span class="sd">          2 : E=a2*x**2 + a0</span>
<span class="sd">          3 : E=a2*x**2 + a1*x + a0</span>

<span class="sd">        The fit coefficient(s) and r-squared describing the accuracy of the fit are returned.</span>

<span class="sd">        :param x:</span>
<span class="sd">        :type x:</span>
<span class="sd">        :param y:</span>
<span class="sd">        :type y:</span>
<span class="sd">        :param num:  (Default value = 2)</span>
<span class="sd">        :type num:</span>
<span class="sd">        :returns:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Starting estimates for the actual fit</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
            <span class="n">p0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span><span class="p">,</span> <span class="n">infodict</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">ier</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span>
            <span class="nb">eval</span><span class="p">(</span><span class="s">&#39;self.distortion_poly{0}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">)),</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">)</span>

        <span class="c"># Compute error estimate for the fit</span>
        <span class="n">residuals</span> <span class="o">=</span> <span class="n">infodict</span><span class="p">[</span><span class="s">&#39;fvec&#39;</span><span class="p">]</span>
        <span class="n">chisqr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">residuals</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">redchi</span> <span class="o">=</span> <span class="n">chisqr</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">ss_tot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rsquared</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">chisqr</span> <span class="o">/</span> <span class="n">ss_tot</span>
        <span class="c">#fitE = self.predicted() + self.eMin</span>

        <span class="c"># Make sure the return variable is always an array</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">popt</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))):</span>
            <span class="n">popt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">popt</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">popt</span><span class="p">,</span> <span class="n">rsquared</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pyEMTO 0.9.0 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Henrik Levämäki, Matti Ropo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>